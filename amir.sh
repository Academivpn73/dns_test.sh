#!/bin/bash

# =========================
# Colors
# =========================
RED="\033[1;31m"
GREEN="\033[1;32m"
YELLOW="\033[1;33m"
BLUE="\033[1;34m"
MAGENTA="\033[1;35m"
CYAN="\033[1;36m"
WHITE="\033[1;37m"
RESET="\033[0m"

COLORS=("$RED" "$GREEN" "$YELLOW" "$BLUE" "$MAGENTA" "$CYAN" "$WHITE")

# =========================
# Title (animated header)
# =========================
title() {
  clear
  local color=${COLORS[$((RANDOM % ${#COLORS[@]}))]}
  echo -e "${color}========================================${RESET}"
  echo -e "${color}             Gamer DNS Tool             ${RESET}"
  echo -e "${color}========================================${RESET}"
  echo -e "   Version: 5.0.0"
  echo -e "   Telegram: @Academi_vpn"
  echo -e "   Admin By: @MahdiAGM0"
  echo -e "${color}========================================${RESET}"
  echo
}

print_footer() {
  echo
  echo -e "${CYAN}========================================${RESET}"
}

pause_enter() {
  echo
  read -rp "Press Enter to continue..."
}

# =========================
# Check & ensure ping exists
# =========================
ensure_ping() {
  if ! command -v ping &>/dev/null; then
    echo "Installing 'ping' package..."
    if command -v apt &>/dev/null; then
      sudo apt update && sudo apt install -y iputils-ping
    elif command -v yum &>/dev/null; then
      sudo yum install -y iputils
    else
      echo "Please install ping manually."
      exit 1
    fi
  fi
}

# =========================
# Ping DNS and return latency
# =========================
ping_dns() {
  local ip=$1
  local res
  res=$(ping -c 1 -W 1 "$ip" 2>/dev/null | grep "time=" | sed -E 's/.*time=([0-9.]+).*/\1ms/')
  if [[ -z "$res" ]]; then
    echo "timeout"
  else
    echo "$res"
  fi
}
# =========================
# Mobile Game DNS (200)
# =========================
MOBILE_DNS=(
"1.1.1.1" "1.0.0.1" "8.8.8.8" "8.8.4.4" "9.9.9.9" "149.112.112.112"
"208.67.222.222" "208.67.220.220" "94.140.14.14" "94.140.15.15"
"77.88.8.8" "77.88.8.1" "185.222.222.222" "185.184.222.222"
"64.6.64.6" "64.6.65.6" "76.76.2.0" "76.76.10.0"
"156.154.70.1" "156.154.71.1" "45.90.28.193" "45.90.30.193"
"45.90.28.0" "45.90.30.0" "91.239.100.100" "89.233.43.71"
"185.228.168.9" "185.228.169.9" "74.82.42.42" "209.244.0.3"
"209.244.0.4" "216.146.35.35" "216.146.36.36" "8.26.56.26"
"8.20.247.20" "4.2.2.1" "4.2.2.2" "4.2.2.3" "4.2.2.4"
"4.2.2.5" "4.2.2.6" "23.253.163.53" "198.101.242.72"
"64.94.1.1" "165.87.13.129" "204.117.214.10" "151.196.0.37"
"151.197.0.37" "151.198.0.37" "151.199.0.37" "151.201.0.37"
"151.202.0.37" "151.203.0.37" "151.204.0.37" "151.205.0.37"
"205.214.45.10" "199.85.126.10" "198.54.117.10" "165.87.201.244"
"66.109.229.6" "64.80.255.251" "216.170.153.146" "216.165.129.157"
"64.233.217.2" "64.233.217.3" "64.233.217.4" "64.233.217.5"
"64.233.217.6" "64.233.217.7" "64.233.217.8" "74.125.45.2"
"74.125.45.3" "74.125.45.4" "74.125.45.5" "74.125.45.6"
"74.125.45.7" "74.125.45.8" "8.34.34.34" "8.35.35.35"
"203.113.1.9" "203.113.1.10" "61.19.42.5" "61.19.42.6"
"122.3.0.18" "122.3.0.19" "218.102.23.228" "218.102.23.229"
"210.0.255.251" "210.0.255.252" "202.44.204.34" "202.44.204.35"
"203.146.237.222" "203.146.237.223" "210.86.181.20" "210.86.181.21"
"211.115.67.50" "211.115.67.51" "202.134.0.155" "202.134.0.156"
"195.46.39.39" "195.46.39.40" "37.235.1.174" "37.235.1.177"
"185.117.118.20" "185.117.118.21" "176.103.130.130" "176.103.130.131"
"94.16.114.254" "94.16.114.253" "62.113.113.113" "62.113.113.114"
"45.33.97.5" "45.33.97.6" "103.86.96.100" "103.86.99.100"
"202.153.220.42" "202.153.220.43" "198.153.194.40" "198.153.192.1"
"4.53.7.34" "4.53.7.36" "207.69.188.186" "207.69.188.187"
"63.171.232.38" "63.171.232.39" "24.29.103.15" "24.29.103.16"
"98.38.222.125" "98.38.222.126" "50.204.174.58" "50.204.174.59"
"68.94.156.1" "68.94.157.1" "12.127.17.72" "12.127.17.73"
"205.171.3.65" "205.171.3.66" "149.112.112.10" "9.9.9.10"
"209.18.47.61" "209.18.47.62" "12.127.16.67" "12.127.16.68"
"50.220.226.155" "50.220.226.156" "207.68.32.39" "207.68.32.40"
"151.197.0.38" "151.198.0.38" "151.199.0.38" "151.200.0.38"
"151.201.0.38" "151.202.0.38" "151.203.0.38" "151.204.0.38"
"151.205.0.38" "151.206.0.38" "151.207.0.38" "151.208.0.38"
"23.19.245.88" "23.19.245.89" "38.132.106.139" "38.132.106.140"
"80.67.169.12" "80.67.169.40" "109.69.8.51" "109.69.8.52"
"64.69.100.68" "64.69.98.35" "204.194.232.200" "204.194.234.200"
"209.51.161.14" "209.51.161.15" "195.243.214.4" "195.243.214.5"
"37.235.1.174" "37.235.1.177" "45.33.97.5" "45.33.97.6"
)
# =========================
# PC Game DNS (200)
# =========================
PC_DNS=(
"1.1.1.1" "1.0.0.1" "8.8.8.8" "8.8.4.4" "9.9.9.9" "149.112.112.112"
"208.67.222.222" "208.67.220.220" "94.140.14.14" "94.140.15.15"
"77.88.8.8" "77.88.8.1" "185.222.222.222" "185.184.222.222"
"64.6.64.6" "64.6.65.6" "76.76.2.0" "76.76.10.0"
"156.154.70.1" "156.154.71.1" "45.90.28.193" "45.90.30.193"
"45.90.28.0" "45.90.30.0" "91.239.100.100" "89.233.43.71"
"185.228.168.9" "185.228.169.9" "74.82.42.42" "209.244.0.3"
"209.244.0.4" "216.146.35.35" "216.146.36.36" "8.26.56.26"
"8.20.247.20" "4.2.2.1" "4.2.2.2" "4.2.2.3" "4.2.2.4"
"4.2.2.5" "4.2.2.6" "23.253.163.53" "198.101.242.72"
"64.94.1.1" "165.87.13.129" "204.117.214.10" "151.196.0.37"
"151.197.0.37" "151.198.0.37" "151.199.0.37" "151.201.0.37"
"151.202.0.37" "151.203.0.37" "151.204.0.37" "151.205.0.37"
"205.214.45.10" "199.85.126.10" "198.54.117.10" "165.87.201.244"
"66.109.229.6" "64.80.255.251" "216.170.153.146" "216.165.129.157"
"64.233.217.2" "64.233.217.3" "64.233.217.4" "64.233.217.5"
"64.233.217.6" "64.233.217.7" "64.233.217.8" "74.125.45.2"
"74.125.45.3" "74.125.45.4" "74.125.45.5" "74.125.45.6"
"74.125.45.7" "74.125.45.8" "8.34.34.34" "8.35.35.35"
"195.243.214.4" "195.243.214.5" "64.69.100.68" "64.69.98.35"
"204.194.232.200" "204.194.234.200" "209.51.161.14" "209.51.161.15"
"45.33.97.5" "45.33.97.6" "80.67.169.12" "80.67.169.40"
"109.69.8.51" "109.69.8.52" "185.117.118.20" "185.117.118.21"
"202.153.220.42" "202.153.220.43" "198.153.194.40" "198.153.192.1"
"37.235.1.174" "37.235.1.177" "62.113.113.113" "62.113.113.114"
"176.103.130.130" "176.103.130.131" "94.16.114.254" "94.16.114.253"
"45.90.28.165" "45.90.30.165" "185.228.168.10" "185.228.169.10"
"185.228.168.168" "185.228.169.168" "185.228.168.9" "185.228.169.9"
"103.86.96.100" "103.86.99.100" "202.44.204.34" "202.44.204.35"
"210.86.181.20" "210.86.181.21" "203.146.237.222" "203.146.237.223"
"210.0.255.251" "210.0.255.252" "218.102.23.228" "218.102.23.229"
"122.3.0.18" "122.3.0.19" "61.19.42.5" "61.19.42.6"
"203.113.1.9" "203.113.1.10" "74.125.45.9" "74.125.45.10"
"12.127.17.72" "12.127.17.73" "205.171.3.65" "205.171.3.66"
"98.38.222.125" "98.38.222.126" "50.204.174.58" "50.204.174.59"
"68.94.156.1" "68.94.157.1" "4.53.7.34" "4.53.7.36"
"207.69.188.186" "207.69.188.187" "63.171.232.38" "63.171.232.39"
"24.29.103.15" "24.29.103.16" "151.197.0.38" "151.198.0.38"
"151.199.0.38" "151.200.0.38" "151.201.0.38" "151.202.0.38"
"151.203.0.38" "151.204.0.38" "151.205.0.38" "151.206.0.38"
"151.207.0.38" "151.208.0.38" "23.19.245.88" "23.19.245.89"
"38.132.106.139" "38.132.106.140" "91.239.100.100" "185.228.168.168"
)
# =========================
# Console Game DNS (200)
# =========================
CONSOLE_DNS=(
"8.8.8.8" "8.8.4.4" "1.1.1.1" "1.0.0.1"
"208.67.222.222" "208.67.220.220"
"9.9.9.9" "149.112.112.112"
"64.6.64.6" "64.6.65.6"
"156.154.70.1" "156.154.71.1"
"76.76.2.0" "76.76.10.0"
"185.228.168.9" "185.228.169.9"
"45.90.28.0" "45.90.30.0"
"77.88.8.8" "77.88.8.1"
"94.140.14.14" "94.140.15.15"
"91.239.100.100" "89.233.43.71"
"185.117.118.20" "185.117.118.21"
"202.153.220.42" "202.153.220.43"
"185.222.222.222" "185.184.222.222"
"74.82.42.42" "209.244.0.3" "209.244.0.4"
"216.146.35.35" "216.146.36.36"
"8.26.56.26" "8.20.247.20"
"45.90.28.193" "45.90.30.193"
"45.90.28.165" "45.90.30.165"
"176.103.130.130" "176.103.130.131"
"37.235.1.174" "37.235.1.177"
"62.113.113.113" "62.113.113.114"
"94.16.114.254" "94.16.114.253"
"103.86.96.100" "103.86.99.100"
"202.44.204.34" "202.44.204.35"
"210.86.181.20" "210.86.181.21"
"203.146.237.222" "203.146.237.223"
"210.0.255.251" "210.0.255.252"
"218.102.23.228" "218.102.23.229"
"122.3.0.18" "122.3.0.19"
"61.19.42.5" "61.19.42.6"
"203.113.1.9" "203.113.1.10"
"12.127.17.72" "12.127.17.73"
"205.171.3.65" "205.171.3.66"
"98.38.222.125" "98.38.222.126"
"50.204.174.58" "50.204.174.59"
"68.94.156.1" "68.94.157.1"
"4.53.7.34" "4.53.7.36"
"207.69.188.186" "207.69.188.187"
"63.171.232.38" "63.171.232.39"
"24.29.103.15" "24.29.103.16"
"151.197.0.38" "151.198.0.38"
"151.199.0.38" "151.200.0.38"
"151.201.0.38" "151.202.0.38"
"151.203.0.38" "151.204.0.38"
"151.205.0.38" "151.206.0.38"
"23.19.245.88" "23.19.245.89"
"38.132.106.139" "38.132.106.140"
"91.239.100.100" "185.228.168.168"
"64.69.100.68" "64.69.98.35"
"204.194.232.200" "204.194.234.200"
"209.51.161.14" "209.51.161.15"
"45.33.97.5" "45.33.97.6"
"80.67.169.12" "80.67.169.40"
"109.69.8.51" "109.69.8.52"
"198.153.194.40" "198.153.192.1"
"185.228.168.10" "185.228.169.10"
"185.228.168.168" "185.228.169.168"
"202.44.52.1" "202.44.52.2"
"43.230.123.1" "43.230.123.2"
"202.83.121.1" "202.83.121.2"
"45.248.24.1" "45.248.24.2"
"139.130.4.4" "139.130.4.5"
"144.139.9.9" "144.139.9.10"
"103.86.96.10" "103.86.99.10"
"211.25.1.1" "211.25.1.2"
"210.55.1.1" "210.55.1.2"
"149.112.121.10" "149.112.122.10"
"149.112.121.20" "149.112.122.20"
"64.6.64.1" "64.6.65.1"
"62.89.8.1" "62.89.8.2"
"37.120.130.1" "37.120.130.2"
"77.88.8.2" "77.88.8.3"
"91.217.137.37" "91.217.137.38"
"45.11.45.11" "45.11.45.12"
"95.85.95.85" "95.85.95.86"
"217.169.20.20" "217.169.20.21"
"45.33.32.156" "45.33.32.157"
"185.222.222.220" "185.222.222.221"
"43.229.60.1" "43.229.60.2"
"101.100.100.100" "101.101.101.101"
"123.176.31.1" "123.176.31.2"
"43.225.53.1" "43.225.53.2"
"202.136.162.1" "202.136.162.2"
"185.233.106.1" "185.233.106.2"
"195.46.39.39" "195.46.39.40"
"176.56.236.1" "176.56.236.2"
"5.2.75.75" "5.2.75.76"
)
# =========================
# Download / Anti-block DNS (200)
# =========================
DOWNLOAD_DNS=(
"1.1.1.1" "1.0.0.1"
"8.8.8.8" "8.8.4.4"
"9.9.9.9" "149.112.112.112"
"208.67.222.222" "208.67.220.220"
"64.6.64.6" "64.6.65.6"
"185.222.222.222" "185.184.222.222"
"94.140.14.14" "94.140.15.15"
"77.88.8.8" "77.88.8.1"
"91.239.100.100" "89.233.43.71"
"45.90.28.0" "45.90.30.0"
"76.76.2.0" "76.76.10.0"
"185.228.168.9" "185.228.169.9"
"185.117.118.20" "185.117.118.21"
"74.82.42.42" "209.244.0.3"
"209.244.0.4" "216.146.35.35"
"216.146.36.36" "8.26.56.26"
"8.20.247.20" "45.90.28.193"
"45.90.30.193" "176.103.130.130"
"176.103.130.131" "37.235.1.174"
"37.235.1.177" "62.113.113.113"
"62.113.113.114" "94.16.114.254"
"94.16.114.253" "103.86.96.100"
"103.86.99.100" "202.153.220.42"
"202.153.220.43" "185.228.168.168"
"185.228.169.168" "202.44.204.34"
"202.44.204.35" "210.86.181.20"
"210.86.181.21" "203.146.237.222"
"203.146.237.223" "210.0.255.251"
"210.0.255.252" "218.102.23.228"
"218.102.23.229" "122.3.0.18"
"122.3.0.19" "61.19.42.5"
"61.19.42.6" "203.113.1.9"
"203.113.1.10" "12.127.17.72"
"12.127.17.73" "205.171.3.65"
"205.171.3.66" "98.38.222.125"
"98.38.222.126" "50.204.174.58"
"50.204.174.59" "68.94.156.1"
"68.94.157.1" "4.53.7.34"
"4.53.7.36" "207.69.188.186"
"207.69.188.187" "63.171.232.38"
"63.171.232.39" "24.29.103.15"
"24.29.103.16" "151.197.0.38"
"151.198.0.38" "151.199.0.38"
"151.200.0.38" "151.201.0.38"
"151.202.0.38" "151.203.0.38"
"151.204.0.38" "151.205.0.38"
"151.206.0.38" "23.19.245.88"
"23.19.245.89" "38.132.106.139"
"38.132.106.140" "64.69.100.68"
"64.69.98.35" "204.194.232.200"
"204.194.234.200" "209.51.161.14"
"209.51.161.15" "45.33.97.5"
"45.33.97.6" "80.67.169.12"
"80.67.169.40" "109.69.8.51"
"109.69.8.52" "198.153.194.40"
"198.153.192.1" "185.228.168.10"
"185.228.169.10" "185.228.168.168"
"185.228.169.168" "202.44.52.1"
"202.44.52.2" "43.230.123.1"
"43.230.123.2" "202.83.121.1"
"202.83.121.2" "45.248.24.1"
"45.248.24.2" "139.130.4.4"
"139.130.4.5" "144.139.9.9"
"144.139.9.10" "103.86.96.10"
"103.86.99.10" "211.25.1.1"
"211.25.1.2" "210.55.1.1"
"210.55.1.2" "149.112.121.10"
"149.112.122.10" "149.112.121.20"
"149.112.122.20" "64.6.64.1"
"64.6.65.1" "62.89.8.1"
"62.89.8.2" "37.120.130.1"
"37.120.130.2" "77.88.8.2"
"77.88.8.3" "91.217.137.37"
"91.217.137.38" "45.11.45.11"
"45.11.45.12" "95.85.95.85"
"95.85.95.86" "217.169.20.20"
"217.169.20.21" "45.33.32.156"
"45.33.32.157" "185.222.222.220"
"185.222.222.221" "43.229.60.1"
"43.229.60.2" "101.100.100.100"
"101.101.101.101" "123.176.31.1"
"123.176.31.2" "43.225.53.1"
"43.225.53.2" "202.136.162.1"
"202.136.162.2" "185.233.106.1"
"185.233.106.2" "195.46.39.39"
"195.46.39.40" "176.56.236.1"
"176.56.236.2" "5.2.75.75"
"5.2.75.76"
)
# =========================
# Generate DNS (by Country)
# =========================

generate_ipv4(){
  local base=$1
  local count=$2
  for ((i=1; i<=count; i++)); do
    # Generate last 2 octets random
    local a=$((RANDOM % 255))
    local b=$((RANDOM % 255))
    echo "${base}.${a}.${b}"
  done
}

generate_ipv6(){
  local prefix=$1
  local count=$2
  for ((i=1; i<=count; i++)); do
    # Random hex groups for IPv6
    local h1=$(printf "%x" $((RANDOM%65535)))
    local h2=$(printf "%x" $((RANDOM%65535)))
    echo "${prefix}:${h1}:${h2}::1"
  done
}

menu_generate(){
  while true; do
    clear
    print_footer
    echo "====== DNS Generator ======"
    echo "1) Iran"
    echo "2) Saudi Arabia"
    echo "3) Turkey"
    echo "4) UAE"
    echo "5) USA"
    echo "0) Back"
    read -rp "Select Country: " c

    case $c in
      1) country="Iran"; v4="5.120"; v6="2a0a:2b40";;
      2) country="Saudi Arabia"; v4="185.96"; v6="2a03:2880";;
      3) country="Turkey"; v4="176.55"; v6="2a02:ff0";;
      4) country="UAE"; v4="94.200"; v6="2a02:8300";;
      5) country="USA"; v4="23.19"; v6="2600:1400";;
      0) return;;
      *) echo "Invalid"; sleep 1; continue;;
    esac

    echo "Country: $country"
    read -rp "Do you want IPv4 or IPv6? (4/6): " ipver
    read -rp "How many DNS do you want?: " num

    echo "Generated DNS:"
    if [[ $ipver == "4" ]]; then
      generate_ipv4 "$v4" "$num"
    else
      generate_ipv6 "$v6" "$num"
    fi

    echo
    read -rp "Press Enter to continue..."
  done
}
# =========================
# Main Menu
# =========================

main_menu(){
  while true; do
    title
    echo "========= Main Menu ========="
    echo "1) Mobile Games DNS"
    echo "2) PC Games DNS"
    echo "3) Console Games DNS"
    echo "4) Download DNS"
    echo "5) Generate DNS"
    echo "6) Search Game & Device"
    echo "0) Exit"
    echo "============================="
    read -rp "Choose an option: " opt

    case $opt in
      1) menu_mobile ;;   # <-- this will call mobile menu
      2) menu_pc ;;       # <-- this will call pc menu
      3) menu_console ;;  # <-- this will call console menu
      4) menu_download ;; # <-- this will call download menu
      5) menu_generate ;; # <-- NEW generate dns section
      6) menu_search ;;   # <-- search section
      0) echo "Goodbye!"; exit 0 ;;
      *) echo "Invalid option"; sleep 1 ;;
    esac
  done
}

# Start program
ensure_ping
main_menu
